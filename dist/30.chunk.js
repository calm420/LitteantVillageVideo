webpackJsonp([30],{207:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(600),r=a(o),i=n(1),l=a(i),s=n(2),u=a(s),c=n(3),f=a(c),h=n(4),d=a(h);n(603);var p=n(0),m=a(p);n(682);var v,g=function(e){function t(e){(0,l.default)(this,t);var n=(0,f.default)(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onChange=function(e){n.setState({value:e})},n.dedupe=function(e){return Array.from(new Set(e))},n.clear=function(){n.setState({value:""})},n.toSearchResult=function(){var e=WebServiceUtil.mobileServiceURL+"serachResult?serachValue="+v.state.value+"&userId="+v.state.userId,t={method:"openNewPage",url:e};Bridge.callHandler(t,null,function(t){window.location.href=e})},n.toSearchResultNo=function(e){var t=WebServiceUtil.mobileServiceURL+"serachResult?serachValue="+e+"&userId="+v.state.userId,n={method:"openNewPage",url:t};Bridge.callHandler(n,null,function(e){window.location.href=t})},n.serach=function(){v.state.searchHistory.forEach(function(e,t){e==v.state.value&&v.state.searchHistory.splice(t,1)}),v.state.searchHistory.push(v.state.value),v.setState({searchHistory:v.removeEmptyArrayEle(v.state.searchHistory)}),localStorage.setItem("serachArr",JSON.stringify(v.state.searchHistory))},n.clearSession=function(){v.setState({searchHistory:[]}),localStorage.removeItem("serachArr")},n.cancelPage=function(){var e={method:"finish"};Bridge.callHandler(e,null,function(e){console.log(e)})},v=n,n.state={showCancelButton:!1,searchHistory:[],value:""},n}return(0,d.default)(t,e),(0,u.default)(t,[{key:"componentWillReceiveProps",value:function(){window.addEventListener("resize",this.onWindwoResize)}},{key:"componentDidMount",value:function(){document.title="搜索页面";var e=window.location.href,t=e.substr(e.indexOf("?")+1),n=t.split("&"),a=n[0].split("=")[1];v.setState({userId:a});for(var o=localStorage.getItem("serachArr"),n=JSON.parse(o)||[],r=[],i=0;i<n.length;i++)-1==r.indexOf(n[i])&&r.push(n[i]);v.setState({searchHistory:v.removeEmptyArrayEle(r)}),$(".am-search-value").keydown(function(e){13==e.keyCode&&(v.serach(),v.toSearchResult())})}},{key:"onWindwoResize",value:function(){setTimeout(function(){v.setState({clientHeight:v.state.clientHeight})},100)}},{key:"removeEmptyArrayEle",value:function(e){for(var t=0;t<e.length;t++)""==e[t]&&(e.splice(t,1),t-=1);return e}},{key:"render",value:function(){var e=this;return m.default.createElement("div",{id:"searchHistory"},m.default.createElement("div",{className:"line_public"},m.default.createElement(r.default,{id:"search",onSubmit:function(e){return console.log(e,"onSubmit")},onClear:function(e){return console.log(e,"onClear")},onFocus:function(){return console.log("onFocus")},onBlur:function(){return console.log("onBlur")},onCancel:this.cancelPage,onChange:this.onChange,showCancelButton:v.state.showCancelButton,placeholder:"请输入搜索内容",maxLength:8})),m.default.createElement("div",{className:"historyCont"},m.default.createElement("p",{className:"searchTxt"},"历史搜索",m.default.createElement("span",{onClick:v.clearSession},"清空")),v.state.searchHistory.map(function(t,n){return m.default.createElement("div",{className:"item",onClick:v.toSearchResultNo.bind(e,t)},t)})))}}]),t}(m.default.Component);t.default=g},268:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return Object.keys(e).reduce(function(t,n){return"aria-"!==n.substr(0,5)&&"data-"!==n.substr(0,5)&&"role"!==n||(t[n]=e[n]),t},{})},e.exports=t.default},600:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function o(e){return window.requestAnimationFrame?window.requestAnimationFrame(e):window.setTimeout(e,1)}function r(e){window.cancelAnimationFrame?window.cancelAnimationFrame(e):window.clearTimeout(e)}Object.defineProperty(t,"__esModule",{value:!0});var i=n(5),l=a(i),s=n(20),u=a(s),c=n(1),f=a(c),h=n(2),d=a(h),p=n(3),m=a(p),v=n(4),g=a(v),y=n(8),C=a(y),w=n(0),R=a(w),S=n(6),b=a(S),B=n(58),E=a(B),P=n(268),_=a(P),N=n(84),x=n(601),k=function(e){function t(e){(0,f.default)(this,t);var n=(0,m.default)(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));n.onSubmit=function(e){e.preventDefault(),n.props.onSubmit&&n.props.onSubmit(n.state.value||""),n.inputRef&&n.inputRef.blur()},n.onChange=function(e){n.state.focus||n.setState({focus:!0});var t=e.target.value;"value"in n.props||n.setState({value:t}),n.props.onChange&&n.props.onChange(t)},n.onFocus=function(){n.setState({focus:!0}),n.firstFocus=!0,n.props.onFocus&&n.props.onFocus()},n.onBlur=function(){n.onBlurTimeout=o(function(){n.blurFromOnClear||document.activeElement!==n.inputRef&&n.setState({focus:!1}),n.blurFromOnClear=!1}),n.props.onBlur&&n.props.onBlur()},n.onClear=function(){n.doClear()},n.doClear=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];n.blurFromOnClear=e,"value"in n.props||n.setState({value:""}),n.props.onClear&&n.props.onClear(""),n.props.onChange&&n.props.onChange(""),e&&n.focus()},n.onCancel=function(){n.props.onCancel?n.props.onCancel(n.state.value||""):n.doClear(!1)},n.focus=function(){n.inputRef&&n.inputRef.focus()};var a=void 0;return a="value"in e?e.value||"":"defaultValue"in e?e.defaultValue:"",n.state={value:a,focus:!1},n}return(0,g.default)(t,e),(0,d.default)(t,[{key:"componentDidMount",value:function(){if(this.rightBtnRef){var e=window.getComputedStyle(this.rightBtnRef);this.rightBtnInitMarginleft=e.marginLeft}this.componentDidUpdate()}},{key:"componentDidUpdate",value:function(){if(this.syntheticPhRef)if(this.inputContainerRef&&this.inputContainerRef.className.indexOf(this.props.prefixCls+"-start")>-1){if(this.syntheticPhContainerRef){var e=this.syntheticPhContainerRef.getBoundingClientRect().width;this.syntheticPhRef.style.width=Math.ceil(e)+"px"}!this.props.showCancelButton&&this.rightBtnRef&&(this.rightBtnRef.style.marginRight="0")}else this.syntheticPhRef.style.width="100%",!this.props.showCancelButton&&this.rightBtnRef&&(this.rightBtnRef.style.marginRight="-"+(this.rightBtnRef.offsetWidth+(null!=this.rightBtnInitMarginleft?parseInt(this.rightBtnInitMarginleft,10):0))+"px")}},{key:"componentWillReceiveProps",value:function(e){"value"in e&&e.value!==this.state.value&&this.setState({value:e.value})}},{key:"componentWillUnmount",value:function(){this.onBlurTimeout&&(r(this.onBlurTimeout),this.onBlurTimeout=null)}},{key:"render",value:function(){var e,t=this,a=this.props,o=a.prefixCls,r=a.showCancelButton,i=a.disabled,s=a.placeholder,c=a.className,f=a.style,h=a.maxLength,d=(0,N.getComponentLocale)(this.props,this.context,"SearchBar",function(){return n(602)}),p=d.cancelText,m=this.state,v=m.value,g=m.focus,y=(0,C.default)(o,c,(0,u.default)({},o+"-start",!!(g||v&&v.length>0))),w=(0,C.default)(o+"-clear",(0,u.default)({},o+"-clear-show",!!(g&&v&&v.length>0))),S=(0,C.default)(o+"-cancel",(e={},(0,u.default)(e,o+"-cancel-show",!!(r||g||v&&v.length>0)),(0,u.default)(e,o+"-cancel-anim",this.firstFocus),e));return R.default.createElement("form",{onSubmit:this.onSubmit,className:y,style:f,ref:function(e){return t.inputContainerRef=e},action:"#"},R.default.createElement("div",{className:o+"-input"},R.default.createElement("div",{className:o+"-synthetic-ph",ref:function(e){return t.syntheticPhRef=e}},R.default.createElement("span",{className:o+"-synthetic-ph-container",ref:function(e){return t.syntheticPhContainerRef=e}},R.default.createElement("i",{className:o+"-synthetic-ph-icon"}),R.default.createElement("span",{className:o+"-synthetic-ph-placeholder",style:{visibility:s&&!v?"visible":"hidden"}},s))),R.default.createElement("input",(0,l.default)({type:"search",className:o+"-value",value:v,disabled:i,placeholder:s,onChange:this.onChange,onFocus:this.onFocus,onBlur:this.onBlur,ref:function(e){return t.inputRef=e},maxLength:h},(0,_.default)(this.props))),R.default.createElement(E.default,{activeClassName:o+"-clear-active"},R.default.createElement("a",{onClick:this.onClear,className:w}))),R.default.createElement("div",{className:S,onClick:this.onCancel,ref:function(e){return t.rightBtnRef=e}},this.props.cancelText||p))}}]),t}(R.default.Component);t.default=k,k.defaultProps=x.defaultProps,k.contextTypes={antLocale:b.default.object},e.exports=t.default},601:function(e,t,n){"use strict";function a(){}Object.defineProperty(t,"__esModule",{value:!0});t.defaultProps={prefixCls:"am-search",placeholder:"",onSubmit:a,onChange:a,onFocus:a,onBlur:a,onClear:a,showCancelButton:!1,disabled:!1}},602:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={cancelText:"取消"},e.exports=t.default},603:function(e,t,n){"use strict";n(16),n(604)},604:function(e,t){},682:function(e,t){}});