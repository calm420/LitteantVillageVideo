webpackJsonp([34],{222:function(e,t,n){"use strict";function c(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(1),a=c(o),i=n(2),s=c(i),r=n(3),l=c(r),u=n(4),d=c(u),f=n(0),m=c(f);n(704);var _=n(396),g=function(e){function t(e){(0,a.default)(this,t);var n=(0,l.default)(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.makeArr=function(e,t){for(var n=0;n<e.length-1;n++)for(var c=n+1;c<e.length;c++)e[n][t]==e[c][t]&&(e.splice(n,1),c--);return e},n.createMachineId=function(){for(var e=[],t="0123456789abcdef",n=0;n<36;n++)e[n]=t.substr(Math.floor(16*Math.random()),1);return e[14]="4",e[19]=t.substr(3&e[19]|8,1),e[8]=e[13]=e[18]=e[23]="-",e.join("")},n.login=function(){if(""!=$("#act").val().trim()&&""!=$("#pwd").val().trim()){var e={method:"LittleAntLogin",colAccount:$("#act").val().trim(),colPasswd:$("#pwd").val().trim()};console.log(e,"param"),WebServiceUtil.requestLittleAntApi6013(JSON.stringify(e),{onResponse:function(e){if(e.success){localStorage.setItem("account",JSON.stringify(e.response));var t=WebServiceUtil.mobileServiceURL+"VillageCardSystemHome?";window.location.href=t}},onError:function(e){}})}},n.accountOnBlur=function(){},n.accountFocus=function(){var e=[];e=null==JSON.parse(localStorage.getItem("accountData"))?e:JSON.parse(localStorage.getItem("accountData")),n.setState({accountArr:n.makeArr(e,"account")},function(){})},n.getAccount=function(e,t){$("#act").val(e),$("#pwd").val(t)},n.deleteAccount=function(e){n.state.accountArr=null==JSON.parse(localStorage.getItem("accountData"))?n.state.accountArr:JSON.parse(localStorage.getItem("accountData")),n.state.accountArr.forEach(function(t,c){c==e&&(n.state.accountArr.splice(c,1),n.setState({accountArr:n.state.accountArr},function(){localStorage.setItem("accountData",JSON.stringify(n.state.accountArr))}))})},n.state={accountArr:[]},n}return(0,d.default)(t,e),(0,s.default)(t,[{key:"componentDidMount",value:function(){document.title="登录页面",Bridge.setRefreshAble(!1);var e=decodeURI(window.location.href),t=e.substr(e.indexOf("?")+1),n=t.split("&"),c=n[0].split("=")[1];this.setState({version:c});var o=new _.SimpleWebsocketConnection;o.connect(),this.createMachineId(),o.msgWsListener={onError:function(e){},onWarn:function(e){},onMessage:function(e){if("allowLoginTeachSystem"==e.command){var t=e.data;t.uuid}}}}},{key:"render",value:function(){var e=this;return m.default.createElement("div",{id:"villageCardSystemLogin"},m.default.createElement("div",{className:"villageLogin-bgLeft"}),m.default.createElement("div",{className:"account empty_center"},m.default.createElement("div",{className:"villageLogo"}),m.default.createElement("div",{className:"title"},"村村向上"),m.default.createElement("div",{className:"inputWrap"},m.default.createElement("span",{className:"login-icon"},m.default.createElement("i",{className:"icon-user"})),m.default.createElement("input",{id:"act",onBlur:this.accountOnBlur,onFocus:this.accountFocus,type:"text",placeholder:"请输入小蚂蚁账号"}),m.default.createElement("div",{style:{display:"none"},id:"actData"},m.default.createElement("div",{className:"cont"},this.state.accountArr.map(function(t,n){return m.default.createElement("div",{className:"item"},m.default.createElement("span",{onClick:e.getAccount.bind(e,t.account,t.password)},t.account),m.default.createElement("span",{className:"close",onClick:e.deleteAccount.bind(e,n)},"删除"))})))),m.default.createElement("div",{className:"inputWrap"},m.default.createElement("span",{className:"login-icon"},m.default.createElement("i",{className:"icon-lock"})),m.default.createElement("input",{id:"pwd",type:"password",placeholder:"请输入密码"})),m.default.createElement("button",{id:"login",className:"loginBtn",onClick:this.login},"登录")))}}]),t}(m.default.Component);t.default=g},396:function(module,__webpack_exports__,__webpack_require__){"use strict";function SimpleWebsocketConnection(){this.msgWsListener=null,this.REMOTE_URL="wss://www.maaee.com:7891/Excoord_SimpleWsServer/simple",this.LOCAL_URL="ws://192.168.50.15:8891/Excoord_SimpleWsServer/simple",this.WS_URL=isDebug?this.LOCAL_URL:this.REMOTE_URL,this.ws=null,this.PING_COMMAND="ping_0123456789_abcdefg",this.PONG_COMMAND="pong_0123456789_abcdefg",this.connected=!1,this.connecting=!1,this.reconnectTimeout,this.heartBeatTimeout,this.connect=function(){var connection=this;connection.connecting=!0,connection.ws=new WebSocket(connection.WS_URL),connection.ws.onmessage=function(event){if(connection.connecting=!1,event.data==connection.PING_COMMAND)return void connection.send(connection.PONG_COMMAND);if(event.data==connection.PONG_COMMAND)return void console.log("收到服务器的 pong");if(null!=connection.msgWsListener){var jsonMessage=eval("("+event.data+")");if(-1==jsonMessage.statusCode){var errorResult=jsonMessage.errorResult;connection.msgWsListener.onError(errorResult.message)}else if(0==jsonMessage.statusCode){var warnResult=jsonMessage.warnResult;connection.msgWsListener.onWarn(warnResult.message)}else if(1==jsonMessage.statusCode){var infoResult=jsonMessage.infoResult,command=infoResult.command;connection.msgWsListener.onMessage(infoResult)}}},connection.ws.onclose=function(e){connection.connecting=!1,connection.connected=!1,connection.reconnect()},connection.ws.onopen=function(e){connection.connecting=!1,connection.connected=!0},connection.ws.onerror=function(e){connection.connecting=!1}},this.closeConnection=function(){var e=this;clearTimeout(e.reconnectTimeout),clearTimeout(e.heartBeatTimeout),e.ws.close()},this.reconnect=function(){var e=this;e.connected||e.connecting||(e.reconnectTimeout=setTimeout(function(){e.connect(),e.reconnect(),console.log("重连中 ...")},1e4))},this.send=function(e){var t=this;!t.connecting&&t.connected&&t.ws.send(JSON.stringify(e))},this.heartBeat=function(){var e=this,t=e.PING_COMMAND;e.heartBeatTimeout=setTimeout(function(){e.send(t),e.heartBeat()},1e4)},this.heartBeat()}Object.defineProperty(__webpack_exports__,"__esModule",{value:!0}),__webpack_exports__.SimpleWebsocketConnection=SimpleWebsocketConnection;var __WEBPACK_IMPORTED_MODULE_0_react__=__webpack_require__(0),__WEBPACK_IMPORTED_MODULE_0_react___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_react__),isDebug=!1},704:function(e,t){}});